<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crisis Monitor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font@master/fonts.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Computer Modern Serif", Georgia, "Times New Roman", serif;
            background: #fff;
            color: #333;
            line-height: 1.15;
            font-size: 13px;
        }
        
        .container {
            max-width: 650px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        h1 {
            font-size: 0.95rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .subtitle {
            font-size: 0.8rem;
            text-align: center;
            margin-bottom: 2rem;
            color: #333;
        }
        
        hr {
            border: none;
            border-top: 0.5px solid #000;
            margin: 2rem 0;
        }
        
        .nav-links {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .nav-links a {
            color: #0066cc;
            text-decoration: none;
            font-size: 0.8rem;
            margin: 0 1rem;
        }
        
        .nav-links a:hover {
            text-decoration: underline;
        }
        
        .map-container {
            margin: 2rem 0;
            border: 1px solid #ddd;
        }
        
        .map-frame {
            width: 100%;
            height: 70vh;
            border: none;
            display: block;
        }
        
        .stats-section {
            margin: 2rem 0;
        }
        
        .stats-title {
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .stats-column h3 {
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .stat-item {
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
            color: #333;
        }
        
        .crisis-categories {
            margin-top: 1rem;
        }
        
        .category-item {
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
            color: #333;
        }
        
        .about-section {
            margin: 2rem 0;
        }
        
        .about-section h2 {
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .about-section p {
            font-size: 0.8rem;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .tech-list {
            font-size: 0.7rem;
            color: #666;
            margin-top: 1rem;
        }
        
        .footer {
            text-align: center;
            font-size: 0.75rem;
            color: #666;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 0.5px solid #000;
        }
        
        .footer a {
            color: #0066cc;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .map-stats-layout {
            position: relative;
        }
        
        .map-container {
            width: 100%;
        }
        
        .stats-panel {
            position: absolute;
            top: 0;
            right: -320px;
            width: 300px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .stats-panel {
                position: static;
                right: auto;
                width: 100%;
                margin-top: 1rem;
            }
            
            .map-frame {
                height: 50vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-links">
            <a href="https://github.com/pierrev34/global-crisis-monitor" target="_blank">view source code</a>
        </div>
        
        <!-- Map and Statistics Layout -->
        <div class="map-stats-layout">
            <!-- Interactive Map -->
            <div class="map-container" id="map">
                <iframe 
                    src="./crisis_map.html" 
                    class="map-frame"
                    title="Interactive Crisis Map">
                </iframe>
            </div>
            
            <!-- Statistics Panel -->
            <div class="stats-panel">
                <h2 class="stats-title">Live Data</h2>
                
                <div class="stat-item">Events: <span id="crisis-count">3</span></div>
                <div class="stat-item">Sources: <span id="source-count">2</span></div>
                
                <div style="margin-top: 1rem; font-size: 0.7rem; color: #666;">
                    <span id="last-update">Updated: 2025-10-01 23:03</span>
                </div>
            </div>
        </div>
        
        <hr>
        
        <!-- About Section -->
        <div class="about-section">
            <h2>System Overview</h2>
            <p>
                This system monitors 15+ crisis sources including NGOs, human rights organizations, and 
                disaster monitoring agencies. It uses rule-based classification to categorize events, 
                extracts geographic entities using natural language processing, and generates interactive 
                maps for humanitarian analysis.
            </p>
            <p>
                The pipeline aggregates from Human Rights Watch, Amnesty International, UN OCHA, ReliefWeb, 
                Radio Free Asia, GDACS, and regional outlets. It employs spaCy for named entity recognition 
                and Nominatim for geocoding with crisis zone overrides.
            </p>
            <div class="tech-list">
                Technology stack: Python, spaCy NER, Geopy, Folium, NGO RSS feeds, GitHub Actions
            </div>
        </div>
        
    </div>

    <script>
        // Load statistics from crisis_summary.json
        fetch('./crisis_summary.json')
            .then(response => response.json())
            .then(data => {
                // Update simplified statistics
                document.getElementById('crisis-count').textContent = 
                    data.pipeline_stats?.crisis_articles_found || '3';
                document.getElementById('source-count').textContent = '2'; // CNN sources
                
                // Update timestamp
                const timestamp = data.timestamp ? new Date(data.timestamp).toLocaleString() : '2025-10-01 23:03';
                document.getElementById('last-update').textContent = `Updated: ${timestamp.split(',')[0]}`;
            })
            .catch(error => {
                console.log('Using demo data');
                // Keep default values
            });
    </script>
</body>
</html>
